<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pferderennen ‚Äì Einstieg Stochastik (Klasse 12)</title>
  <style>
    :root{
      --track-width: 760px;
      --lane-height: 64px;
      --horses: 8;
      --fields: 6; /* Start + 5 Felder bis Ziel */
      --wood:#8b5a2b;
      --grass:#4caf50;
      --sky:#87ceeb;
    }
    *{box-sizing:border-box;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    body{background: linear-gradient(180deg,var(--sky),#cfefff 40%, #f7f7f7); margin:0; padding:24px; color:#222}
    h1{margin:0 0 12px 0; font-size:20px}
    .wrapper{max-width:980px;margin:0 auto}

    .card{background:linear-gradient(#fff,#fbfbfb); border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,0.08); padding:18px}

    .controls{display:flex;gap:12px;align-items:center;margin-bottom:12px}
    .buzzer{background:radial-gradient(circle at 30% 30%, #ff6b6b, #c92a2a); border:none;color:white; padding:14px 18px; font-weight:700; font-size:18px; border-radius:10px; cursor:pointer; box-shadow:0 6px 14px rgba(201,42,42,0.35)}
    .buzzer:active{transform:translateY(2px)}
    .btn{background:#fff;border:1px solid #e0e0e0;padding:10px 12px;border-radius:8px;cursor:pointer}
    .info{font-size:14px;color:#444}

    /* Race area */
    .track{width:var(--track-width); margin:14px 0; border-radius:8px; overflow:hidden; border:6px solid var(--wood); background:linear-gradient(to bottom, #bc8f5a, #a76f3b); padding:12px}
    .lane{display:flex;align-items:center;height:var(--lane-height); margin:6px 0; position:relative}
    .lane::before{content:'';position:absolute;left:0;right:0;height:100%;top:0;background:linear-gradient(90deg, rgba(0,0,0,0.02) 0%, rgba(255,255,255,0.02) 100%);}
    .fields{display:flex;flex:1;gap:6px;padding:6px}
    .field{flex:1; height:100%; border-radius:6px; background:linear-gradient(#f3f3f3,#e9e9e9); border:1px solid rgba(0,0,0,0.06); display:flex;align-items:center;justify-content:center; position:relative}
    .field.goal{background:linear-gradient(#fff6b3,#fff0a1); box-shadow:inset 0 0 0 2px rgba(255,220,40,0.06)}
    .horse{width:56px;height:48px; border-radius:8px; display:flex;align-items:center;justify-content:center; font-weight:800; transition:transform 300ms cubic-bezier(.2,.9,.2,1); position:relative}

    /* horse styles by index */
    .horse.--0{background:#ffecb3;border:2px solid #f4c150}
    .horse.--1{background:#ffe0e6;border:2px solid #ff8aa6}
    .horse.--2{background:#e8f5e9;border:2px solid #66bb6a}
    .horse.--3{background:#e3f2fd;border:2px solid #42a5f5}
    .horse.--4{background:#f3e5f5;border:2px solid #ab47bc}
    .horse.--5{background:#fff3e0;border:2px solid #ffb74d}
    .horse.--6{background:#efebe9;border:2px solid #8d6e63}
    .horse.--7{background:#fbe9e7;border:2px solid #ff7043}

    .horse .emoji{font-size:22px;margin-right:6px}
    .horse .name{font-size:12px}

    .lane .number{width:34px; text-align:center; font-weight:700; color:#fff; text-shadow:0 1px 0 rgba(0,0,0,0.25)}
    .lane .number.padded{margin-right:8px}

    .finish-line{position:absolute;right:6px;top:0;bottom:0;width:6px;background:repeating-linear-gradient(180deg,#fff,#fff 6px,#000 6px,#000 12px); border-radius:3px}

    .indicator{display:flex;gap:8px;align-items:center}
    .podium{display:none;margin-top:12px;padding:12px;background:linear-gradient(#fff,#fdfdfd);border-radius:10px;border:1px solid #eee}
    .podium .title{font-weight:800;margin-bottom:8px}
    .winners{display:flex;gap:12px}
    .winner{flex:1;padding:10px;border-radius:8px;background:linear-gradient(#fafafa,#fff); border:1px solid #eee; text-align:center}
    .ribbon{display:inline-block;padding:6px 10px;border-radius:999px;font-weight:700}
    .ribbon.gold{background:linear-gradient(#ffd54f,#ffb300)}
    .ribbon.silver{background:linear-gradient(#e0e0e0,#bdbdbd)}
    .ribbon.bronze{background:linear-gradient(#ffcc80,#ff8a65)}

    .track-footer{display:flex;justify-content:space-between;align-items:center;gap:12px}

    /* small screens */
    @media (max-width:820px){:root{--track-width:100%} .horse{width:48px;height:40px}}
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="card">
      <h1>Pferderennen ‚Äî Einstieg Stochastik (Klasse 12)</h1>
      <div class="controls">
        <button class="buzzer" id="buzzer">BUZZER (auch Leertaste)</button>
        <button class="btn" id="restart">Neustart</button>
        <div style="flex:1" class="info">Dr√ºcke den Buzzer: zuf√§llig wird eines der 8 Pferde ausgew√§hlt ‚Äî es r√ºckt ein Feld vor. <strong>Ziel nach 5 Feldern</strong>. Das Spiel endet, sobald 3 Pferde im Ziel sind.</div>
      </div>

      <div class="track" id="track" aria-live="polite">
        <!-- Lanes werden per JS erzeugt -->
      </div>

      <div class="track-footer">
        <div class="indicator">Z√ºge: <strong id="turnCounter">0</strong></div>
        <div class="indicator">Noch im Rennen: <strong id="aliveCount">8</strong></div>
      </div>

      <div class="podium" id="podium" role="status">
        <div class="title">Siegerehrung ‚Äî die ersten 3</div>
        <div class="winners" id="winners"></div>
      </div>

    </div>

    <p style="margin-top:10px; color:#555; font-size:13px">Didaktischer Hinweis: Dieses Spiel eignet sich als intuitiver Einstieg in Zufallsprozesse und Ziehungen mit und ohne Zur√ºcklegen. Der Buzzer simuliert eine gleichverteilte Zufallsauswahl √ºber die noch nicht platzierten Pferde; durch Beobachtung der Ergebnisse lassen sich Begriffe wie Erwartungswert, Varianz, Unabh√§ngigkeit und bedingte Wahrscheinlichkeiten einf√ºhren.</p>
  </div>

  <script>
    // Einstellungen
    const HORSES = 8;
    const FIELDS_TO_GOAL = 5; // nach 5 Feldern ist das Ziel erreicht

    // Pferdenamen (in Anlehnung an typische Rennpferde-Labels)
    const NAMES = ['Blitz','Aurora','Tigerherz','Smaragda','Vento','Sonnenkuss','Albatros','Rubina'];
    const EMOJIS = ['üêé','üèá','üê¥','üêé','üèá','üê¥','üêé','üèá'];

    // Status
    let positions = new Array(HORSES).fill(0);
    let finished = []; // {idx, name, turn}
    let turn = 0;

    const track = document.getElementById('track');
    const buzzer = document.getElementById('buzzer');
    const restart = document.getElementById('restart');
    const turnCounter = document.getElementById('turnCounter');
    const aliveCount = document.getElementById('aliveCount');
    const podium = document.getElementById('podium');
    const winners = document.getElementById('winners');

    // Aufbau der Bahnen
    function buildTrack(){
      track.innerHTML = '';
      for(let i=0;i<HORSES;i++){
        const lane = document.createElement('div'); lane.className='lane'; lane.dataset.idx=i;
        const num = document.createElement('div'); num.className='number padded'; num.textContent = (i+1);
        lane.appendChild(num);

        const fields = document.createElement('div'); fields.className='fields';
        for(let f=0;f<FIELDS_TO_GOAL+1;f++){
          const field = document.createElement('div'); field.className='field';
          if(f===FIELDS_TO_GOAL) field.classList.add('goal');
          field.dataset.field = f;
          fields.appendChild(field);
        }
        lane.appendChild(fields);

        const horse = document.createElement('div'); horse.className = `horse --${i}`; horse.dataset.horse=i;
        horse.innerHTML = `<span class="emoji">${EMOJIS[i]||'üêé'}</span><span class="name">${NAMES[i]}</span>`;
        // Startposition (in erstes Feld)
        fields.children[0].appendChild(horse);

        // Finish line visual
        const finishLine = document.createElement('div'); finishLine.className='finish-line'; lane.appendChild(finishLine);

        track.appendChild(lane);
      }
      updateIndicators();
    }

    // w√§hle zuf√§llig ein noch nicht fertiges Pferd
    function chooseRandomAlive(){
      const alive = [];
      for(let i=0;i<HORSES;i++) if(!finished.find(f=>f.idx===i)) alive.push(i);
      if(alive.length===0) return null;
      const choice = alive[Math.floor(Math.random()*alive.length)];
      return choice;
    }

    function moveHorse(i){
      if(finished.find(f=>f.idx===i)) return; // bereits fertig
      positions[i] = positions[i] + 1;
      // Begrenze
      if(positions[i] > FIELDS_TO_GOAL) positions[i] = FIELDS_TO_GOAL;
      // DOM manipulieren: verschiebe .horse in das entsprechende Feld
      const lane = track.querySelector(`.lane[data-idx='${i}']`);
      const fields = lane.querySelectorAll('.field');
      const horse = lane.querySelector('.horse');
      fields[positions[i]].appendChild(horse);

      // kleine Animation (Skalieren)
      horse.style.transform = 'translateY(-6px)';
      setTimeout(()=> horse.style.transform = '', 220);

      // Wenn im Ziel angekommen
      if(positions[i] >= FIELDS_TO_GOAL){
        // Falls noch nicht verzeichnet
        if(!finished.find(f=>f.idx===i)){
          finished.push({idx:i, name:NAMES[i], turn:turn});
          markFinished(i, finished.length);
        }
      }
    }

    function markFinished(i, place){
      const lane = track.querySelector(`.lane[data-idx='${i}']`);
      lane.querySelector('.horse').style.opacity = '0.9';
      lane.querySelector('.number').textContent = (i+1) + ' ‚ôõ';
      // kleines Band
      const band = document.createElement('div'); band.className='ribbon';
      if(place===1) band.classList.add('gold');
      if(place===2) band.classList.add('silver');
      if(place===3) band.classList.add('bronze');
      band.textContent = '#'+place;
      lane.querySelector('.fields').appendChild(band);
    }

    function doTurn(){
      if(finished.length>=3) return; // Spiel beendet
      const pick = chooseRandomAlive();
      if(pick===null) return;
      turn++;
      turnCounter.textContent = turn;
      moveHorse(pick);
      updateIndicators();
      checkEnd();
    }

    function updateIndicators(){
      const alive = HORSES - finished.length;
      aliveCount.textContent = alive;
    }

    function checkEnd(){
      if(finished.length>=3){
        // Zeige Siegerehrung
        showPodium();
        buzzer.disabled = true;
        buzzer.style.opacity = 0.7;
      }
    }

    function showPodium(){
      podium.style.display = 'block';
      winners.innerHTML='';
      const top = finished.slice(0,3);
      const classes = ['gold','silver','bronze'];
      top.forEach((f,idx)=>{
        const w = document.createElement('div'); w.className='winner';
        w.innerHTML = `<div style="font-size:20px">${EMOJIS[f.idx]||'üêé'}</div><div style="font-weight:800;margin-top:6px">${f.name}</div><div class="ribbon ${classes[idx]}" style="margin-top:8px">${idx+1}. Platz</div>`;
        winners.appendChild(w);
      });
    }

    function resetGame(){
      positions = new Array(HORSES).fill(0);
      finished = [];
      turn = 0;
      turnCounter.textContent = '0';
      podium.style.display='none';
      buzzer.disabled = false; buzzer.style.opacity = 1;
      buildTrack();
    }

    // Event-Handler
    buzzer.addEventListener('click', ()=>{
      doTurn();
    });
    restart.addEventListener('click', ()=>{
      resetGame();
    });
    // Leertaste als Buzzer
    window.addEventListener('keydown', (e)=>{
      if(e.code==='Space'){
        e.preventDefault();
        if(!buzzer.disabled) doTurn();
      }
    });

    // Initialisierung
    buildTrack();

    // F√ºr Lehrer: Simulationsmodus (klick auf Track f√ºhrt 20 Z√ºge automatisch aus)
    track.addEventListener('dblclick',(e)=>{
      // Falls Sie m√∂chten: 20 schnelle Z√ºge
      let steps=20; const id = setInterval(()=>{
        if(steps--<=0 || finished.length>=3) { clearInterval(id); return; }
        doTurn();
      }, 220);
    });

  </script>
</body>
</html>
